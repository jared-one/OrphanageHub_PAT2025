# DETAILED FILE SELECTION SUMMARY

**Generated:** 2025-09-14 12:27:37
**Directory:** `/home/jared/OrphanageHub_PAT2025/src/main/java/com/orphanagehub/service`
**Total Files:** 2

---

## Files by Type

### .java (2 files)

- `VolunteerService.java` (12.8 KB)
- `AdminService.java` (17.2 KB)

---

## File Previews

### ðŸ“„ VolunteerService.java

**Size:** 12.8 KB

```java
package com.orphanagehub.service;

import com.orphanagehub.dao.*;
import com.orphanagehub.model.*;
import io.vavr.collection.List;
import io.vavr.control.Option;
import io.vavr.control.Try;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.time.LocalDateTime;

/**
 * Service for volunteer operations.
 * 
 * @author OrphanageHub Team
 * @version 2.0
 * @since 2025-09-06
 */
public class VolunteerService {
    private static final Logger logger = LoggerFactory.getLogger(VolunteerService.class);
    
    private final VolunteerOpportunityDAO opportunityDAO = new VolunteerOpportunityDAO();
    private final VolunteerApplicationDAO applicationDAO = new VolunteerApplicationDAO();
    private final UserDAO userDAO = new UserDAO();
    private final OrphanageDAO orphanageDAO = new OrphanageDAO();
    private final NotificationDAO notificationDAO = new NotificationDAO();
    private final AuditLogDAO auditLogDAO = new AuditLogDAO();
    
    /**
     * Searches volunteer opportunities
     */
    public Try<List<VolunteerOpportunity>> searchOpportunities(OpportunitySearchCriteria criteria) {
        return opportunityDAO.findOpenOpportunities()
            .map(opportunities -> {
                List<VolunteerOpportunity> filtered = opportunities;
                
                // Filter by category
                if (criteria.category() != null) {
                    filtered = filtered.filter(o -> o.category().equals(criteria.category()));
                }
                
                // Filter by skills
                if (criteria.skills() != null && !criteria.skills().isEmpty()) {
                    filtered = filtered.filter(o -> 
                        o.skillsRequired().map(skills ->
                            criteria.skills().exists(skill ->
                                skills.toLowerCase().contains(skill.toLowerCase())
                            )
                        ).getOrElse(true)
                    );
                }
                
                // Filter by time commitment
                if (criteria.maxHoursPerWeek() != null) {
                    filtered = filtered.filter(o ->
                        o.hoursPerWeek().map(hours -> 
                            hours <= criteria.maxHoursPerWeek()
                        ).getOrElse(true)
                    );
                }
                
                // Filter by location
                if (criteria.city() != null || criteria.province() != null) {
                    filtered = filterByLocation(filtered, criteria.city(), criteria.province());
                }
                
                // Filter by age eligibility
                if (criteria.volunteerAge() != null) {
                    filtered = filtered.filter(o -> o.isAgeEligible(criteria.volunteerAge()));
                }
                
                // Sort
                if (criteria.sortBy() != null) {
                    filtered = sortOpportunities(filtered, criteria.sortBy());
                }
                
                return filtered;
            });
    }
    
    /**
     * Applies for volunteer opportunity
     */
    public Try<VolunteerApplication> applyForOpportunity(
            Integer opportunityId, Integer volunteerId,
            ApplicationDetails details) {
        
        // Check if already applied
        return applicationDAO.hasApplied(volunteerId, opportunityId)
            .flatMap(hasApplied -> {
                if (hasApplied) {
                    return Try.failure(new ServiceException("You have already applied for this opportunity"));
                }
                
                // Get opportunity details
                return opportunityDAO.findById(opportunityId)
                    .flatMap(oppOpt -> oppOpt.toTry(() -> 
                        new ServiceException("Opportunity not found")))
                    .flatMap(opportunity -> {
                        // Check if opportunity is open
                        if (!opportunity.isOpen()) {
                            return Try.failure(new ServiceException("This opportunity is no longer available"));
                        }
                        
                        // Check age eligibility
                        userDAO.findById(volunteerId).forEach(userOpt -> {
                            userOpt.forEach(user -> {
                                user.dateOfBirth().forEach(dob -> {
                                    int age = java.time.Period.between(dob, java.time.LocalDate.now()).getYears();
                                    if (!opportunity.isAgeEligible(age)) {
                                        throw new RuntimeException("You do not meet the age requirements");
                                    }
                                });
                            });
                        });
                        
                        // Create application
                        VolunteerApplication application = VolunteerApplication.create(
                            opportunityId,
                         
... (truncated to 5KB)
```

### ðŸ“„ AdminService.java

**Size:** 17.2 KB

```java
package com.orphanagehub.service;

import com.orphanagehub.dao.*;
import com.orphanagehub.model.*;
import io.vavr.collection.List;
import io.vavr.control.Option;
import io.vavr.control.Try;
import net.sf.jasperreports.engine.*;
import net.sf.jasperreports.engine.export.JRPdfExporter;
import net.sf.jasperreports.export.SimpleExporterInput;
import net.sf.jasperreports.export.SimpleOutputStreamExporterOutput;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.io.File;
import java.io.FileOutputStream;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.HashMap;
import java.util.Map;

/**
 * Complete admin service with all management functions.
 * 
 * @author OrphanageHub Team
 * @version 2.0
 * @since 2025-09-06
 */
public class AdminService {
    private static final Logger logger = LoggerFactory.getLogger(AdminService.class);
    
    private final UserDAO userDAO = new UserDAO();
    private final OrphanageDAO orphanageDAO = new OrphanageDAO();
    private final DonationDAO donationDAO = new DonationDAO();
    private final ResourceRequestDAO requestDAO = new ResourceRequestDAO();
    private final VolunteerOpportunityDAO opportunityDAO = new VolunteerOpportunityDAO();
    private final VolunteerApplicationDAO applicationDAO = new VolunteerApplicationDAO();
    private final NotificationDAO notificationDAO = new NotificationDAO();
    private final AuditLogDAO auditLogDAO = new AuditLogDAO();
    
    /**
     * Gets system dashboard statistics
     */
    public Try<SystemStatistics> getSystemStatistics() {
        return Try.of(() -> {
            // User statistics
            int totalUsers = userDAO.findAllActive().map(List::size).getOrElse(0);
            int donors = userDAO.findByRole("Donor").map(List::size).getOrElse(0);
            int volunteers = userDAO.findByRole("Volunteer").map(List::size).getOrElse(0);
            int orphanageStaff = userDAO.findByRole("OrphanageRep").map(List::size).getOrElse(0);
            
            // Orphanage statistics
            int totalOrphanages = orphanageDAO.findAllVerified().map(List::size).getOrElse(0);
            int pendingVerifications = orphanageDAO.findByVerificationStatus("Pending")
                .map(List::size).getOrElse(0);
            
            // Donation statistics
            double totalDonations = donationDAO.getTotalDonations().getOrElse(0.0);
            int monthlyDonations = donationDAO.getMonthlyDonationCount().getOrElse(0);
            
            // Request statistics
            int openRequests = requestDAO.findOpenRequests().map(List::size).getOrElse(0);
            int urgentRequests = requestDAO.findUrgentRequests().map(List::size).getOrElse(0);
            
            // Volunteer statistics
            int activeOpportunities = opportunityDAO.findOpenOpportunities()
                .map(List::size).getOrElse(0);
            int pendingApplications = applicationDAO.getPendingApplicationCount().getOrElse(0);
            
            return new SystemStatistics(
                totalUsers,
                donors,
                volunteers,
                orphanageStaff,
                totalOrphanages,
                pendingVerifications,
                totalDonations,
                monthlyDonations,
                openRequests,
                urgentRequests,
                activeOpportunities,
                pendingApplications
            );
        });
    }
    
    /**
     * Manages user account (activate/suspend/delete)
     */
    public Try<Void> manageUserAccount(Integer userId, String action, Integer adminId, String reason) {
        return userDAO.findById(userId)
            .flatMap(userOpt -> userOpt.toTry(() -> 
                new ServiceException("User not found")))
            .flatMap(user -> {
                User updated = switch (action.toLowerCase()) {
                    case "activate" -> user.withAccountStatus("Active");
                    case "suspend" -> user.withAccountStatus("Suspended");
                    case "delete" -> user.withAccountStatus("Deleted");
                    default -> throw new ServiceException("Invalid action: " + action);
                };
                
                return userDAO.update(updated)
                    .flatMap(u -> {
                        // Send notification to user
                        String message = "Your account has been " + action.toLowerCase() + "d";
                        if (reason != null) {
                            message += ". Reason: " + reason;
                        }
                        
                        Notification notification = Notification.create(
                            userId,
                            Notification.TYPE_SYSTEM,
                            "Account Status Changed",
                            message,
                            Notification.PRIORITY_HIGH
                        );
                        notificationDAO.create(notification);
                        
                        // Log action
                      
... (truncated to 5KB)
```


---

## Statistics

- **Total Files:** 2
- **Total Size:** 30.0 KB
- **File Types:** 1
- **Average Size:** 15.0 KB